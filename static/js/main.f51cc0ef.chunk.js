(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{192:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(40),i=n.n(c),r=(n(87),n(10)),s=n(3),l=function(e){return e.currentUser},u=n(0),d=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,o=e.onCardDelete,c=Object(s.c)(l).user,i=t.owner._id===c._id,r="element__button-delete ".concat(i?"":"card__delete-button_hidden"),d=t.likes.some((function(e){return e._id===c._id})),p="element__like ".concat(d?"element__like_active":"");return Object(u.jsxs)("li",{className:"element",children:[Object(u.jsx)("button",{type:"button",className:r,onClick:function(){o(t)}}),Object(u.jsx)("img",{src:t.link,alt:t.name,onClick:function(){return n(t)},className:"element__image"}),Object(u.jsxs)("div",{className:"element__group",children:[Object(u.jsx)("h2",{className:"element__title",children:t.name}),Object(u.jsxs)("div",{className:"element__like-group",children:[Object(u.jsx)("button",{type:"button",className:p,onClick:function(){a(t)}}),Object(u.jsx)("span",{className:"element__like-counter",children:t.likes.length})]})]})]})},p=function(){return Object(u.jsx)("div",{style:{height:"71vh"},children:Object(u.jsx)("div",{className:"Spinner"})})},j="SET_CARDS",b="ADD_CARD",h="DELETE_CARD",O="LIKE_CARD",m="SET_USER",_="SET_EDIT_PROFILE_POPUP_OPEN",f="SET_ADD_PLACE_POPUP_OPEN",g="SET_EDIT_AVATAR_POPUP_OPEN",x="SET_POPUP_WITH_SUBMIT_OPEN",v="CLOSE_ALL_POPUPS",y="SET_LOADING",N="SET_SELECTED_CARD",P="SET_CARD_TO_DELETE",C="SET_LOADING_BTN",T="SET_LOGGED_IN",k="SET_CURRENT_EMAIL",S="SET_SUCCESS_POPUP_OPEN",L="SET_FAIL_POPUP_OPEN",E=function(e){return{type:N,payload:e}},A=function(e){return e.initialCards},U=function(e){var t=e.onCardLike,n=e.onCardDelete,a=Object(s.c)(A),o=a.cards,c=a.isLoading,i=Object(s.c)(l).user,r=Object(s.b)();function j(e){r(E(e))}return Object(u.jsx)("main",{className:"main",children:c?Object(u.jsx)(p,{}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsxs)("div",{className:"profile__wrapper",children:[Object(u.jsxs)("div",{className:"profile__image-wrapper",children:[Object(u.jsx)("img",{onClick:function(){r({type:g,payload:!0})},src:i.avatar,alt:"\u0444\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__image"}),Object(u.jsx)("button",{className:"profile__image-btn"})]}),Object(u.jsxs)("div",{className:"profile__info",children:[Object(u.jsx)("h1",{className:"profile__name",children:i.name}),Object(u.jsx)("button",{onClick:function(){r({type:_,payload:!0})},type:"button",className:"profile__button"}),Object(u.jsx)("p",{className:"profile__job",children:i.about})]})]}),Object(u.jsx)("button",{onClick:function(){r({type:f,payload:!0})},type:"button",className:"profile__button-add"})]}),Object(u.jsx)("section",{className:"elements",children:Object(u.jsx)("ul",{className:"elements__list",children:o.map((function(e){return Object(u.jsx)(d,{card:e,onCardClick:j,onCardLike:t,onCardDelete:n},e._id)}))})})]})})},w=n(78),R=n.n(w),D=function(){var e=R()().format("YYYY");return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",e," Mesto Russia"]})})},I=function(e){var t=e.card,n=e.onClose;return Object(u.jsx)("div",{className:"popup popup_type_image ".concat(t&&"popup_opened"),children:Object(u.jsxs)("div",{className:"popup__container popup__container_type_image",children:[Object(u.jsx)("button",{onClick:n,type:"button",className:"popup__button-close popup__button-close_type_image"}),Object(u.jsx)("img",{src:null===t||void 0===t?void 0:t.link,alt:null===t||void 0===t?void 0:t.name,className:"popup__img"}),Object(u.jsx)("h2",{className:"popup__title",children:null===t||void 0===t?void 0:t.name})]})})},B=n(2),q=function(e){return Object(u.jsx)("div",{className:"popup popup_".concat(e.params.name," ").concat(e.isOpen&&"popup_opened"),children:Object(u.jsxs)("div",{className:"popup__container",children:[Object(u.jsx)("button",{onClick:e.onClose,type:"button",className:"popup__button-close"}),Object(u.jsxs)("form",{onSubmit:e.onSubmit,action:"#",className:"form",name:e.params.formName,children:[Object(u.jsx)("h2",{className:"form__heading",children:e.params.title}),e.children,Object(u.jsx)("button",{type:"submit",className:"form__button ".concat(!e.isValid&&"form__button_disabled"),children:e.loadingBtn?e.params.buttonLoadingText:e.params.buttonText})]})]})})},F=function(e){return e.popups},z=function(e){return e.cardSettings},V=n(12),J=n(18),K=n(17),G=K.a().shape({Email:K.b().email().required(),password:K.b().min(8).max(32).required()}),M=K.a().shape({title:K.b().min(2).required(),link:K.b().url().required()}),W=K.a().shape({userName:K.b().min(2).required(),description:K.b().min(2).required()}),Y=K.a().shape({avatar:K.b().url().required()}),H=function(e){return e.langReducer},X={ru:{header:{singOut:"\u0412\u044b\u0439\u0442\u0438",singIn:"\u0412\u043e\u0439\u0442\u0438",singUp:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"},addPlacePopup:{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",buttonLoadingText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c...",placeholderName:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",placeholderLink:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"},editAvatarPopup:{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonLoadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...",placeholderLink:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"},editProfilePopup:{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonLoadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...",placeholderName:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",placeholderLink:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0440\u043e\u0434 \u0437\u0430\u043d\u044f\u0442\u0438\u044f"},login:{title:"\u0412\u0445\u043e\u0434",buttonText:"\u0412\u043e\u0439\u0442\u0438",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"},register:{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",text:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",textBtn:"\u0412\u043e\u0439\u0442\u0438"}},fi:{header:{singOut:"Kirjaudu ulos",singIn:"Luo tunnus",singUp:"Kirjaudu sis\xe4\xe4n"},addPlacePopup:{title:"Uusi paikka",buttonText:"Luoda",buttonLoadingText:"Luoda...",placeholderName:"Nimi",placeholderLink:"Linkki"},editAvatarPopup:{title:"P\xe4ivit\xe4 avatar",buttonText:"Luoda",buttonLoadingText:"Luoda...",placeholderLink:"Linkki"},editProfilePopup:{title:"Muokata profiili",buttonText:"Luoda",buttonLoadingText:"Luoda...",placeholderName:"Kirjoita nimisi",placeholderLink:"Kirjoita ammattisi"},login:{title:"Luo tunnus",buttonText:"Luo",placeholder:"Salasana"},register:{title:"Kirjaudu sis\xe4\xe4n",buttonText:"Kirjaudu",placeholder:"Salasana",text:"Oletko jo kirjautunut?",textBtn:"Luo tunnus"}}},Q=function(e){var t,n,o=Object(V.d)({resolver:Object(J.a)(W),mode:"onChange"}),c=o.register,i=o.formState.errors,r=o.handleSubmit,d=o.setValue,p=Object(s.c)(l).user,j=Object(s.c)(F).isEditProfilePopupOpen,b=Object(s.c)(z).loadingBtn,h=Object(s.c)(H).selectedLang;Object(a.useEffect)((function(){d("userName",p.name),d("description",p.about)}),[p,d,j]);var O=r((function(t){e.onUpdateUser({userName:t.userName,description:t.description})}));return Object(u.jsxs)(q,{isOpen:j,params:{name:"type_edit",title:"".concat(X[h].editProfilePopup.title),buttonText:"".concat(X[h].editProfilePopup.buttonText),buttonLoadingText:"".concat(X[h].editProfilePopup.buttonLoadingText),formName:"edit-profile"},onClose:e.onClose,loadingBtn:b,isValid:!0,onSubmit:O,children:[Object(u.jsx)("input",Object(B.a)(Object(B.a)({className:"form__input",type:"text",id:"name"},c("userName",{required:!0})),{},{placeholder:X[h].editProfilePopup.placeholderName})),Object(u.jsx)("p",{className:"form__input-error name-input-error",children:null===(t=i.userName)||void 0===t?void 0:t.message}),Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"text",className:"form__input",id:"description"},c("description",{required:!0})),{},{placeholder:X[h].editProfilePopup.placeholderLink})),Object(u.jsx)("p",{className:"form__input-error job-input-error",children:null===(n=i.description)||void 0===n?void 0:n.message})]})},Z=function(e){var t,n=Object(V.d)({resolver:Object(J.a)(Y),mode:"onChange"}),o=n.register,c=n.formState,i=c.errors,r=c.isValid,l=n.handleSubmit,d=n.reset,p=Object(s.c)(H).selectedLang,j=Object(s.c)(F).isEditAvatarPopupOpen,b=Object(s.c)(z).loadingBtn;Object(a.useEffect)((function(){d()}),[d,j]);var h=l((function(t){e.onUpdateAvatar({avatar:t.avatar})}));return Object(u.jsxs)(q,{isOpen:j,onClose:e.onClose,loadingBtn:b,onSubmit:h,isValid:r,params:{name:"type_avatar",title:"".concat(X[p].editAvatarPopup.title),buttonText:"".concat(X[p].editAvatarPopup.buttonText),buttonLoadingText:"".concat(X[p].editAvatarPopup.buttonLoadingText),formName:"change-avatar"},children:[Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"url",className:"form__input",id:"avatar"},o("avatar",{required:!0})),{},{placeholder:X[p].editAvatarPopup.placeholderLink})),Object(u.jsx)("p",{className:"form__input-error avatar-input-error",children:null===(t=i.avatar)||void 0===t?void 0:t.message})]})},$=function(e){var t,n,o=Object(V.d)({resolver:Object(J.a)(M),mode:"onChange"}),c=o.register,i=o.formState,r=i.errors,l=i.isValid,d=o.handleSubmit,p=o.reset,j=Object(s.c)(z).loadingBtn,b=Object(s.c)(F).isAddPlacePopupOpen,h=Object(s.c)(H).selectedLang;Object(a.useEffect)((function(){p()}),[p,b]);var O=d((function(t){e.onAddPlace({title:t.title,link:t.link})}));return Object(u.jsxs)(q,{isOpen:b,params:{name:"new-card",title:"".concat(X[h].addPlacePopup.title),buttonText:"".concat(X[h].addPlacePopup.buttonText),buttonLoadingText:"".concat(X[h].addPlacePopup.buttonLoadingText),formName:"new-card"},onClose:e.onClose,onSubmit:O,isValid:l,loadingBtn:j,children:[Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"text"},c("title",{required:!0})),{},{className:"form__input",id:"title",placeholder:X[h].addPlacePopup.placeholderName})),Object(u.jsx)("p",{className:"title-input-error form__input-error",children:null===(t=r.title)||void 0===t?void 0:t.message}),Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"url",className:"form__input"},c("link",{required:!0})),{},{name:"link",id:"link",placeholder:X[h].addPlacePopup.placeholderLink})),Object(u.jsx)("p",{className:"link-input-error form__input-error",children:null===(n=r.link)||void 0===n?void 0:n.message})]})},ee=function(e){var t=e.onSubmit,n=e.onClose,a=e.cardToDelete,o=Object(s.c)(F).isPopupWithSubmitOpen,c=Object(s.c)(z).loadingBtn;return Object(u.jsx)(q,{isOpen:o,params:{name:"type_confirmation",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",buttonLoadingText:"...",formName:"type_confirmation"},onClose:n,isValid:!0,loadingBtn:c,onSubmit:function(e){e.preventDefault(),t(a)}})},te=n(9),ne=function(e){var t,n,o=e.handleAuthorize,c=Object(V.d)({resolver:Object(J.a)(G),mode:"onBlur"}),i=c.register,l=c.formState.errors,d=c.handleSubmit,p=Object(s.c)(H).selectedLang,j=Object(a.useState)(""),b=Object(r.a)(j,2),h=b[0],O=b[1],m=Object(a.useState)(""),_=Object(r.a)(m,2),f=_[0],g=_[1];return Object(u.jsxs)("form",{onSubmit:d((function(){o(h,f)})),className:"log__in_wrapper",children:[Object(u.jsx)("h4",{className:"log__in_title",children:X[p].login.title}),Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"email",className:"log__in_input",placeholder:"Email"},i("Email",{required:!0})),{},{onChange:function(e){return O(e.target.value)},value:h||""})),Object(u.jsx)("p",{className:"log__in_error",children:null===(t=l.Email)||void 0===t?void 0:t.message}),Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"password",className:"log__in_input",placeholder:X[p].login.placeholder,value:f||""},i("password",{required:!0})),{},{onChange:function(e){return g(e.target.value)}})),Object(u.jsx)("p",{className:"log__in_error",children:null===(n=l.password)||void 0===n?void 0:n.message}),Object(u.jsx)("button",{type:"submit",className:"log__in_button",children:X[p].login.buttonText})]})},ae=n(20),oe=function(e){var t,n,o=e.handleRegister,c=Object(V.d)({resolver:Object(J.a)(G),mode:"onBlur"}),i=c.register,l=c.formState.errors,d=c.handleSubmit,p=Object(a.useState)(""),j=Object(r.a)(p,2),b=j[0],h=j[1],O=Object(a.useState)(""),m=Object(r.a)(O,2),_=m[0],f=m[1],g=Object(s.c)(H).selectedLang;return Object(u.jsxs)("form",{onSubmit:d((function(){o(b,_)})),className:"log__in_wrapper",noValidate:!0,children:[Object(u.jsx)("h4",{className:"log__in_title",children:X[g].register.title}),Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"email",className:"log__in_input",placeholder:"Email",value:b||""},i("Email",{required:!0})),{},{onChange:function(e){return h(e.target.value)}})),Object(u.jsx)("p",{className:"log__in_error",children:null===(t=l.Email)||void 0===t?void 0:t.message}),Object(u.jsx)("input",Object(B.a)(Object(B.a)({type:"password",className:"log__in_input",placeholder:X[g].register.placeholder,value:_||""},i("password",{required:!0})),{},{onChange:function(e){return f(e.target.value)}})),Object(u.jsx)("p",{className:"log__in_error",children:null===(n=l.password)||void 0===n?void 0:n.message}),Object(u.jsx)("button",{type:"submit",className:"log__in_button",children:X[g].register.buttonText}),Object(u.jsxs)("p",{className:"login__form_button-text",children:[X[g].register.text,Object(u.jsx)(ae.b,{to:"/sign-in",children:Object(u.jsxs)("button",{className:"login__form_button",children:[" ",X[g].register.textBtn]})})]})]})},ce="https://auth.nomoreparties.co";function ie(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}var re=function(e){return Object(u.jsx)("div",{className:"popup  ".concat(e.isOpen&&"popup_opened"),children:Object(u.jsxs)("div",{className:"popup__container",children:[Object(u.jsx)("button",{onClick:e.onClose,type:"button",className:"popup__button-close"}),Object(u.jsxs)("div",{className:"success__popup_wrapper",children:[Object(u.jsx)("div",{className:e.className}),Object(u.jsx)("h2",{className:"success__popup_text",children:e.text})]})]})})},se=function(e){var t=e.onClose,n=e.isOpen;return Object(u.jsx)(re,{onClose:t,isOpen:n,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",className:"success__popup_img"})},le=function(e){var t=e.onClose,n=e.isOpen;return Object(u.jsx)(re,{onClose:t,isOpen:n,text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437",className:"fail__popup_img"})},ue="SET_LANG",de={selectedLang:"ru"},pe=function(e){var t=e.signOut,n=e.currentEmail,a=Object(s.b)(),o=Object(s.c)(H).selectedLang;function c(e){a(function(e){return{type:ue,payload:e}}(e))}return Object(u.jsxs)("header",{className:"header",children:[Object(u.jsx)("a",{href:"#",target:"_blank",className:"logo"}),Object(u.jsxs)("div",{className:"select__btn-wrapper",children:[Object(u.jsx)("button",{className:"select__btn-ru ".concat("ru"===o&&"select__btn-active"),onClick:function(){return c("ru")},children:"ru"}),Object(u.jsx)("button",{className:"select__btn-fi ".concat("fi"===o&&"select__btn-active"),onClick:function(){return c("fi")},children:"fi"})]}),Object(u.jsxs)("div",{className:"header__wrapper",children:[n&&Object(u.jsx)("p",{className:"header__wrapper_email",children:n}),Object(u.jsxs)(te.d,{children:[Object(u.jsx)(te.b,{exact:!0,path:"/",children:Object(u.jsx)("button",{onClick:t,className:"header__wrapper_button",children:X[o].header.singOut})}),Object(u.jsx)(te.b,{exact:!0,path:"/sign-up",children:Object(u.jsx)(ae.b,{to:"/sign-in",children:Object(u.jsx)("button",{className:"header__wrapper_button",children:X[o].header.singIn})})}),Object(u.jsx)(te.b,{exact:!0,path:"/sign-in",children:Object(u.jsx)(ae.b,{to:"/sign-up",children:Object(u.jsx)("button",{className:"header__wrapper_button",children:X[o].header.singUp})})})]})]})]})},je=function(e){return{type:L,payload:e}},be=function(e){return{type:x,payload:e}},he=function(e){return{type:m,payload:e}},Oe=function(e){return{type:k,payload:e}},me=function(e){return{type:T,payload:e}},_e=function(e){return{type:C,payload:e}},fe=function(e){return{type:y,payload:e}},ge=n(4),xe=n(5),ve=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(ge.a)(this,e),this.URL=void 0,this.token=void 0,this.URL=n,this.token=a.authorization}return Object(xe.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this.URL,"cards"),{headers:{authorization:this.token}}).then(this._handleResponse)}},{key:"getUserInfoFromServer",value:function(){return fetch("".concat(this.URL,"users/me"),{headers:{authorization:this.token}}).then(this._handleResponse)}},{key:"setUserInfoFromServer",value:function(e){var t=e.userName,n=e.description;return fetch("".concat(this.URL,"users/me"),{method:"PATCH",headers:{authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then(this._handleResponse)}},{key:"addCardToServer",value:function(e){var t=e.title,n=e.link;return fetch("".concat(this.URL,"cards"),{method:"POST",headers:{authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then(this._handleResponse)}},{key:"deleteCardFromServer",value:function(e){return fetch("".concat(this.URL,"cards/").concat(e),{method:"DELETE",headers:{authorization:this.token,"Content-Type":"application/json"}}).then(this._handleResponse)}},{key:"changeLikeCardStatus",value:function(e,t){var n;return n=t?"PUT":"DELETE",fetch("".concat(this.URL,"cards/likes/").concat(e),{method:n,headers:{authorization:this.token,"Content-Type":"application/json"}}).then(this._handleResponse)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this.URL,"users/me/avatar"),{method:"PATCH",headers:{authorization:this.token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.avatar})}).then(this._handleResponse)}},{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-26/",headers:{authorization:"4e299d77-1777-4738-8eea-94761855c603","Content-Type":"application/json"}}),ye=function(){var e=Object(s.b)(),t=Object(s.c)(A).cards,n=Object(s.c)(l),o=n.user,c=n.currentEmail,i=Object(s.c)(z),d=i.selectedCard,p=i.cardToDelete,m=i.loggedIn,_=Object(s.c)(F),f=_.successPopupOpen,g=_.failPopupOpen,x=Object(te.g)();function y(){e({type:v,payload:!1}),e(E(null))}return Object(a.useEffect)((function(){e(fe(!0));var t=ve.getInitialCards(),n=ve.getUserInfoFromServer();Promise.all([t,n]).then((function(t){var n=Object(r.a)(t,2),a=n[0],o=n[1];e(function(e){return{type:j,payload:e}}(a)),e(he(o))})).catch((function(e){console.log(e)})).finally((function(){e(fe(!1))}))}),[e]),Object(a.useEffect)((function(){if(localStorage.getItem("jwt")){var t=localStorage.getItem("jwt");(n=t,fetch("".concat(ce,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){return ie(e)})).then((function(e){return e}))).then((function(t){t&&(e(Oe(t.data.email)),e(me(!0)),x.push("/"))}))}var n}),[x,e]),Object(u.jsx)("div",{className:"App",children:Object(u.jsx)("div",{className:"page",children:Object(u.jsxs)("div",{className:"page__wrapper",children:[Object(u.jsx)(se,{onClose:y,isOpen:f}),Object(u.jsx)(le,{onClose:y,isOpen:g}),Object(u.jsx)(I,{card:d,onClose:y}),Object(u.jsx)(Q,{onUpdateUser:function(t){e(_e(!0)),ve.setUserInfoFromServer(t).then((function(t){e(he(t)),y()})).catch((function(e){console.log(e)})).finally((function(){e(_e(!1))}))},onClose:y}),Object(u.jsx)(Z,{onUpdateAvatar:function(t){e(_e(!0)),ve.changeAvatar(t).then((function(t){e(he(t)),y()})).catch((function(e){console.log(e)})).finally((function(){e(_e(!1))}))},onClose:y}),Object(u.jsx)($,{onClose:y,onAddPlace:function(t){e(_e(!0)),ve.addCardToServer(t).then((function(t){e({type:b,payload:t}),y()})).catch((function(e){console.log(e)})).finally((function(){e(_e(!1))}))}}),Object(u.jsx)(ee,{onClose:y,onSubmit:function(n){e(_e(!0)),ve.deleteCardFromServer(n._id).then((function(a){if("\u041f\u043e\u0441\u0442 \u0443\u0434\u0430\u043b\u0451\u043d"===a.message){var o=t.filter((function(e){return e!==n}));e(function(e){return{type:h,payload:e}}(o)),e(be(!1))}})).catch((function(e){console.log(e)})).finally((function(){e(_e(!1))}))},cardToDelete:p}),Object(u.jsx)(pe,{currentEmail:c,signOut:function(){localStorage.removeItem("jwt"),x.push("/sign-in"),e(me(!1)),e(Oe(""))}}),Object(u.jsxs)(te.d,{children:[Object(u.jsx)(te.b,{exact:!0,path:"/",children:m?Object(u.jsx)(U,{onCardLike:function(n){var a=n.likes.some((function(e){return e._id===o._id}));ve.changeLikeCardStatus(n._id,!a).then((function(a){var o=t.map((function(e){return e._id===n._id?a:e}));e(function(e){return{type:O,payload:e}}(o))})).catch((function(e){console.log(e)}))},onCardDelete:function(t){e(be(!0)),e({type:P,payload:t})}}):Object(u.jsx)(te.a,{to:"/sign-in"})}),Object(u.jsx)(te.b,{path:"/sign-in",children:Object(u.jsx)(ne,{handleAuthorize:function(t,n){(function(e,t){return fetch("".concat(ce,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then((function(e){return ie(e)})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e}))})(t,n).then((function(n){n.token&&(e(me(!0)),e(Oe(t)),x.push("/"))})).catch((function(t){e(je(!0)),console.log(t)}))}})}),Object(u.jsx)(te.b,{path:"/sign-up",children:Object(u.jsx)(oe,{handleRegister:function(t,n){(function(e,t){return fetch("".concat(ce,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then((function(e){return ie(e)})).then((function(e){return e}))})(t,n).then((function(t){e({type:S,payload:!0}),x.push("/sign-in")})).catch((function(t){console.log(t),e(je(!0))}))}})}),Object(u.jsx)(te.b,{path:"/",children:m?Object(u.jsx)(te.a,{to:"/"}):Object(u.jsx)(te.a,{to:"/sign-in"})})]}),Object(u.jsx)(D,{})]})})})},Ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,193)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),c(e),i(e)}))},Pe=n(28),Ce=n(82),Te=n(7),ke={cards:[],isLoading:!1},Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(B.a)(Object(B.a)({},e),{},{cards:t.payload});case b:return Object(B.a)(Object(B.a)({},e),{},{cards:[t.payload].concat(Object(Te.a)(e.cards))});case h:case O:return Object(B.a)(Object(B.a)({},e),{},{cards:t.payload});case y:return Object(B.a)(Object(B.a)({},e),{},{isLoading:t.payload});default:return e}},Le={user:{about:"",avatar:"",cohort:"",name:"",_id:""},currentEmail:""},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(B.a)(Object(B.a)({},e),{},{user:t.payload});case k:return Object(B.a)(Object(B.a)({},e),{},{currentEmail:t.payload});default:return e}},Ae={isEditProfilePopupOpen:!1,isAddPlacePopupOpen:!1,isEditAvatarPopupOpen:!1,isPopupWithSubmitOpen:!1,successPopupOpen:!1,failPopupOpen:!1},Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(B.a)(Object(B.a)({},e),{},{isEditProfilePopupOpen:t.payload});case f:return Object(B.a)(Object(B.a)({},e),{},{isAddPlacePopupOpen:t.payload});case g:return Object(B.a)(Object(B.a)({},e),{},{isEditAvatarPopupOpen:t.payload});case x:return Object(B.a)(Object(B.a)({},e),{},{isPopupWithSubmitOpen:t.payload});case S:return Object(B.a)(Object(B.a)({},e),{},{successPopupOpen:t.payload});case L:return Object(B.a)(Object(B.a)({},e),{},{failPopupOpen:t.payload});case v:return Object(B.a)(Object(B.a)({},e),{},{isPopupWithSubmitOpen:t.payload,isEditAvatarPopupOpen:t.payload,isAddPlacePopupOpen:t.payload,isEditProfilePopupOpen:t.payload,successPopupOpen:t.payload,failPopupOpen:t.payload});default:return e}},we={selectedCard:null,cardToDelete:null,loadingBtn:!1,loggedIn:!1},Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(B.a)(Object(B.a)({},e),{},{selectedCard:t.payload});case P:return Object(B.a)(Object(B.a)({},e),{},{cardToDelete:t.payload});case C:return Object(B.a)(Object(B.a)({},e),{},{loadingBtn:t.payload});case T:return Object(B.a)(Object(B.a)({},e),{},{loggedIn:t.payload});default:return e}},De=Object(Pe.b)({initialCards:Se,currentUser:Ee,popups:Ue,cardSettings:Re,langReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ue:return Object(B.a)(Object(B.a)({},e),{},{selectedLang:t.payload});default:return e}}}),Ie=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Pe.c,Be=Object(Pe.d)(De,Ie(Object(Pe.a)(Ce.a)));i.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(ae.a,{basename:"/kuvasto",children:Object(u.jsx)(s.a,{store:Be,children:Object(u.jsx)(ae.a,{children:Object(u.jsx)(ye,{})})})})}),document.getElementById("root")),Ne()},87:function(e,t,n){}},[[192,1,2]]]);
//# sourceMappingURL=main.f51cc0ef.chunk.js.map